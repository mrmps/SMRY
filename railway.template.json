{
  "$schema": "https://railway.app/railway.schema.json",
  "name": "SMRY.ai",
  "description": "Paywall bypass and article summarization with PostHog analytics",
  "buttons": [
    {
      "name": "Deploy to Railway",
      "provider": "railway"
    }
  ],
  "services": {
    "smry-app": {
      "name": "smry-app",
      "description": "Next.js + Elysia API server",
      "source": {
        "repo": "https://github.com/yourusername/13ft"
      },
      "build": {
        "builder": "DOCKERFILE",
        "dockerfilePath": "Dockerfile"
      },
      "deploy": {
        "restartPolicyType": "ON_FAILURE",
        "restartPolicyMaxRetries": 3,
        "healthcheckPath": "/health",
        "healthcheckTimeout": 30
      },
      "variables": {
        "NEXT_PUBLIC_URL": {
          "description": "Public URL of your deployment (e.g., https://smry.ai)",
          "required": true
        },
        "POSTHOG_API_KEY": {
          "description": "PostHog project API key (server-side)",
          "required": true
        },
        "POSTHOG_HOST": {
          "description": "PostHog instance URL (e.g., https://us.i.posthog.com)",
          "required": true
        },
        "POSTHOG_PROJECT_ID": {
          "description": "PostHog project ID (for HogQL queries)",
          "required": true
        },
        "POSTHOG_PERSONAL_API_KEY": {
          "description": "PostHog personal API key (for HogQL query API)",
          "required": true
        },
        "NEXT_PUBLIC_POSTHOG_KEY": {
          "description": "PostHog project API key (client-side)",
          "required": true
        },
        "NEXT_PUBLIC_POSTHOG_HOST": {
          "description": "PostHog instance URL (client-side)",
          "required": true
        },
        "UPSTASH_REDIS_REST_URL": {
          "description": "Upstash Redis REST URL",
          "required": true
        },
        "UPSTASH_REDIS_REST_TOKEN": {
          "description": "Upstash Redis REST token",
          "required": true
        },
        "DIFFBOT_API_KEY": {
          "description": "Diffbot API key for article extraction",
          "required": false
        },
        "OPENROUTER_API_KEY": {
          "description": "OpenRouter API key for AI summaries",
          "required": false
        },
        "CLERK_SECRET_KEY": {
          "description": "Clerk secret key for authentication",
          "required": true
        },
        "NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY": {
          "description": "Clerk publishable key (must also be passed as build arg)",
          "required": true
        }
      },
      "networking": {
        "public": {
          "enabled": true
        }
      }
    }
  }
}
