# TanStack Start Migration Guide

This document provides guidance and documentation for the Next.js to TanStack Start migration.

---

## CHANGES MADE (2026-01-08)

The following issues have been fixed by the review agent:

### Fixed Files

1. **`src/components/shared/language-switcher.tsx`** - Completely rewritten to use TanStack Router's `useRouter` and `useLocation` hooks instead of non-existent `usePathname`/`useRouter` from `@/i18n/navigation`.

2. **`src/components/shared/underline-link.tsx`** - Migrated from `next/link` to TanStack Router's `Link` component.

3. **`src/components/features/upgrade-modal.tsx`** - Migrated from `next/link` to TanStack Router's `Link` component.

4. **`src/components/features/inline-summary.tsx`** - Migrated all `next/link` imports to TanStack Router's `Link` component.

5. **`src/components/features/summary-form.tsx`** - Migrated all `next/link` imports to TanStack Router's `Link` component.

6. **`src/components/marketing/ad-spot.tsx`** - Replaced `next/image` with `<img>` tags.

7. **`src/components/marketing/upgrade-cta.tsx`** - Replaced `next/image` with `<img>` tags.

### New Files Created

1. **`src/i18n/hooks.ts`** - Re-export file for hooks.

---

## PR Review Build Fixes

1. **`server/routes/summary.ts`** - Fixed import path `../../types/api` â†’ `../../src/types/api`
2. **`package.json`** - Added `"type": "module"` for ESM
3. **`package.json`** - Fixed `@t3-oss/env-core` version to `^0.13.10`
4. **`package.json`** - Added `@clerk/tanstack-react-start`
5. **`src/i18n/navigation.tsx`** - Added `Link` export alias
6. **`src/components/article/content.tsx`** - Replaced `isomorphic-dompurify` with `dompurify`

---

## KNOWN ISSUES

### Clerk Middleware Build Bug

Creating `src/start.ts` with Clerk middleware causes build failures.
See: https://github.com/TanStack/router/issues/6185

**Workaround:** Use ClerkProvider in `__root.tsx` instead.

---

*Last updated: 2026-01-08*
