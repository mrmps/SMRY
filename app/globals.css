@import "tailwindcss";
@plugin "@tailwindcss/typography";
@source "node_modules/streamdown/dist/*.js";

/*
 * Multi-theme support
 * Themes: light, pure-light, dark, magic-blue, classic-dark
 */
@custom-variant dark (&:is(.dark *, .magic-blue *, .classic-dark *));

@theme inline {
  /* Core semantic colors */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  /* Surface elevation system */
  --color-surface-1: var(--surface-1);
  --color-surface-2: var(--surface-2);
  --color-surface-3: var(--surface-3);

  /* Text hierarchy */
  --color-foreground-muted: var(--foreground-muted);
  --color-foreground-faint: var(--foreground-faint);

  /* Semantic status colors */
  --color-success: var(--success);
  --color-success-foreground: var(--success-foreground);
  --color-warning: var(--warning);
  --color-warning-foreground: var(--warning-foreground);
  --color-info: var(--info);
  --color-info-foreground: var(--info-foreground);

  /* Accent color */
  --color-glow: var(--glow);
  --color-glow-muted: var(--glow-muted);

  /* Chart colors */
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);

  /* Sidebar system */
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);

  /* Typography */
  --font-sans: var(--font-sans);
  --font-mono: var(--font-mono);

  /* Radius system */
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
}

/*
 * =============================================================================
 * THEME: Light (default)
 * Warm off-white with subtle warmth - not clinical
 * =============================================================================
 */
:root,
.light {
  --radius: 0.625rem;

  /* Base */
  --background: #fcfcfc;
  --foreground: #2e2f30;

  /* Text hierarchy */
  --foreground-muted: #6b6c6d;
  --foreground-faint: #9a9b9c;

  /* Surfaces */
  --surface-1: #f8f8f8;
  --surface-2: #f3f3f3;
  --surface-3: #ebebeb;

  /* Card & Popover */
  --card: #ffffff;
  --card-foreground: #2e2f30;
  --popover: #ffffff;
  --popover-foreground: #2e2f30;

  /* Primary */
  --primary: #2e2f30;
  --primary-foreground: #fcfcfc;

  /* Secondary */
  --secondary: #f3f3f3;
  --secondary-foreground: #2e2f30;

  /* Muted */
  --muted: #f3f3f3;
  --muted-foreground: #6b6c6d;

  /* Accent */
  --accent: #ebebeb;
  --accent-foreground: #2e2f30;

  /* Destructive */
  --destructive: #e5484d;
  --destructive-foreground: #ffffff;

  /* Borders & inputs */
  --border: #e5e5e5;
  --input: #e5e5e5;
  --ring: #5e69d1;

  /* Accent glow */
  --glow: #5e69d1;
  --glow-muted: #8b93db;

  /* Status colors */
  --success: #30a46c;
  --success-foreground: #ffffff;
  --warning: #f5a623;
  --warning-foreground: #2e2f30;
  --info: #0091ff;
  --info-foreground: #ffffff;

  /* Charts */
  --chart-1: #5e69d1;
  --chart-2: #30a46c;
  --chart-3: #e5484d;
  --chart-4: #f5a623;
  --chart-5: #0091ff;

  /* Sidebar */
  --sidebar: #f8f8f8;
  --sidebar-foreground: #2e2f30;
  --sidebar-primary: #2e2f30;
  --sidebar-primary-foreground: #fcfcfc;
  --sidebar-accent: #ebebeb;
  --sidebar-accent-foreground: #2e2f30;
  --sidebar-border: #e5e5e5;
  --sidebar-ring: #5e69d1;
}

/*
 * =============================================================================
 * THEME: Pure Light
 * Pure white - minimal, clean, bright
 * =============================================================================
 */
.pure-light {
  --background: #ffffff;
  --foreground: #1a1a1a;

  --foreground-muted: #666666;
  --foreground-faint: #999999;

  --surface-1: #fafafa;
  --surface-2: #f5f5f5;
  --surface-3: #eeeeee;

  --card: #ffffff;
  --card-foreground: #1a1a1a;
  --popover: #ffffff;
  --popover-foreground: #1a1a1a;

  --primary: #1a1a1a;
  --primary-foreground: #ffffff;

  --secondary: #f5f5f5;
  --secondary-foreground: #1a1a1a;

  --muted: #f5f5f5;
  --muted-foreground: #666666;

  --accent: #eeeeee;
  --accent-foreground: #1a1a1a;

  --destructive: #dc2626;
  --destructive-foreground: #ffffff;

  --border: #e0e0e0;
  --input: #e0e0e0;
  --ring: #6366f1;

  --glow: #6366f1;
  --glow-muted: #a5b4fc;

  --sidebar: #fafafa;
  --sidebar-foreground: #1a1a1a;
  --sidebar-primary: #1a1a1a;
  --sidebar-primary-foreground: #ffffff;
  --sidebar-accent: #eeeeee;
  --sidebar-accent-foreground: #1a1a1a;
  --sidebar-border: #e0e0e0;
  --sidebar-ring: #6366f1;
}

/*
 * =============================================================================
 * THEME: Dark (Default)
 * Original zinc-based dark theme - clean and neutral
 * =============================================================================
 */
.dark {
  --background: #09090b;
  --foreground: #fafafa;

  --foreground-muted: #a1a1aa;
  --foreground-faint: #71717a;

  --surface-1: #18181b;
  --surface-2: #27272a;
  --surface-3: #3f3f46;

  --card: #09090b;
  --card-foreground: #fafafa;
  --popover: #09090b;
  --popover-foreground: #fafafa;

  --primary: #fafafa;
  --primary-foreground: #18181b;

  --secondary: #27272a;
  --secondary-foreground: #fafafa;

  --muted: #18181b;
  --muted-foreground: #a1a1aa;

  --accent: #18181b;
  --accent-foreground: #fafafa;

  --destructive: #7f1d1d;
  --destructive-foreground: #fecaca;

  --border: #27272a;
  --input: #27272a;
  --ring: #52525b;

  --glow: #5e69d1;
  --glow-muted: #4a52a8;

  --success: #30a46c;
  --success-foreground: #09090b;
  --warning: #f5a623;
  --warning-foreground: #09090b;
  --info: #0091ff;
  --info-foreground: #09090b;

  --chart-1: #3b82f6;
  --chart-2: #22c55e;
  --chart-3: #f59e0b;
  --chart-4: #a855f7;
  --chart-5: #f43f5e;

  --sidebar: #171717;
  --sidebar-foreground: #fafafa;
  --sidebar-primary: #3b82f6;
  --sidebar-primary-foreground: #fafafa;
  --sidebar-accent: #262626;
  --sidebar-accent-foreground: #fafafa;
  --sidebar-border: #27272a;
  --sidebar-ring: #52525b;
}

/*
 * =============================================================================
 * THEME: Magic Blue
 * Dark with subtle blue tint - Linear's signature look
 * Based on Linear's "Magic Blue" theme: rgb(25, 26, 34)
 * =============================================================================
 */
.magic-blue {
  --background: #191a22;
  --foreground: #e4e4ed;

  --foreground-muted: #9a9ba8;
  --foreground-faint: #6b6c78;

  --surface-1: #1f2029;
  --surface-2: #262730;
  --surface-3: #2d2e38;

  --card: #1f2029;
  --card-foreground: #e4e4ed;
  --popover: #262730;
  --popover-foreground: #e4e4ed;

  --primary: #e4e4ed;
  --primary-foreground: #191a22;

  --secondary: #2d2e38;
  --secondary-foreground: #e4e4ed;

  --muted: #262730;
  --muted-foreground: #9a9ba8;

  --accent: #2d2e38;
  --accent-foreground: #e4e4ed;

  --destructive: #e5484d;
  --destructive-foreground: #ffffff;

  --border: #3a3b48;
  --input: #3a3b48;
  --ring: #575ac6;

  --glow: #575ac6;
  --glow-muted: #454899;

  --success: #30a46c;
  --success-foreground: #191a22;
  --warning: #f5a623;
  --warning-foreground: #191a22;
  --info: #0091ff;
  --info-foreground: #191a22;

  --chart-1: #575ac6;
  --chart-2: #30a46c;
  --chart-3: #e5484d;
  --chart-4: #f5a623;
  --chart-5: #0091ff;

  --sidebar: #14151c;
  --sidebar-foreground: #e4e4ed;
  --sidebar-primary: #575ac6;
  --sidebar-primary-foreground: #e4e4ed;
  --sidebar-accent: #262730;
  --sidebar-accent-foreground: #e4e4ed;
  --sidebar-border: #3a3b48;
  --sidebar-ring: #575ac6;
}

/*
 * =============================================================================
 * THEME: Classic Dark
 * Neutral dark gray - no color tint, professional
 * Based on Linear's "Classic Dark" theme: rgb(30, 32, 34)
 * =============================================================================
 */
.classic-dark {
  --background: #1e2022;
  --foreground: #e4e5e9;

  --foreground-muted: #9a9b9f;
  --foreground-faint: #6b6c70;

  --surface-1: #252729;
  --surface-2: #2c2e30;
  --surface-3: #343638;

  --card: #252729;
  --card-foreground: #e4e5e9;
  --popover: #2c2e30;
  --popover-foreground: #e4e5e9;

  --primary: #e4e5e9;
  --primary-foreground: #1e2022;

  --secondary: #343638;
  --secondary-foreground: #e4e5e9;

  --muted: #2c2e30;
  --muted-foreground: #9a9b9f;

  --accent: #343638;
  --accent-foreground: #e4e5e9;

  --destructive: #e5484d;
  --destructive-foreground: #ffffff;

  --border: #404244;
  --input: #404244;
  --ring: #5e69d1;

  --glow: #5e69d1;
  --glow-muted: #4a52a8;

  --success: #30a46c;
  --success-foreground: #1e2022;
  --warning: #f5a623;
  --warning-foreground: #1e2022;
  --info: #0091ff;
  --info-foreground: #1e2022;

  --chart-1: #5e69d1;
  --chart-2: #30a46c;
  --chart-3: #e5484d;
  --chart-4: #f5a623;
  --chart-5: #0091ff;

  --sidebar: #191a1c;
  --sidebar-foreground: #e4e5e9;
  --sidebar-primary: #5e69d1;
  --sidebar-primary-foreground: #e4e5e9;
  --sidebar-accent: #2c2e30;
  --sidebar-accent-foreground: #e4e5e9;
  --sidebar-border: #404244;
  --sidebar-ring: #5e69d1;
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }

  html {
    height: 100%;
    overflow: hidden;
  }

  body {
    @apply bg-background text-foreground;
    height: 100%;
    overflow-x: hidden;
    overflow-y: auto;
    overscroll-behavior-y: none;
  }
}

[data-vaul-no-drag] {
  touch-action: pan-y;
  -webkit-overflow-scrolling: touch;
}

@theme inline {
  --font-heading: var(--font-heading);
  --font-syne: var(--font-syne);
  --font-mono:
    ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
    "Courier New", monospace;
}

@layer base {
  /* Custom scrollbar styling */
  pre::-webkit-scrollbar {
    width: 5px;
  }
  pre::-webkit-scrollbar-track {
    background: transparent;
  }
  pre::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 5px;
  }
  pre {
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }
}

@keyframes scroll {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX(-100%);
  }
}

@theme inline {
  @keyframes skeleton {
    to {
      background-position: -200% 0;
    }
  }
}

/* Chat loader - bouncing dots animation */
.chat-loader {
  width: 20px;
  aspect-ratio: 2.5;
  --_g: no-repeat radial-gradient(circle closest-side, currentColor 100%, transparent);
  background:
    var(--_g) 0%   50%,
    var(--_g) 50%  50%,
    var(--_g) 100% 50%;
  background-size: calc(100%/3) 40%;
  animation: chat-loader-bounce 1s infinite linear;
}

@keyframes chat-loader-bounce {
  20% { background-position: 0%   0%, 50%  50%, 100%  50% }
  40% { background-position: 0% 100%, 50%   0%, 100%  50% }
  60% { background-position: 0%  50%, 50% 100%, 100%   0% }
  80% { background-position: 0%  50%, 50%  50%, 100% 100% }
}

@layer components {
  /* Remove all SVGs in article content */
  .prose svg {
    display: none !important;
  }

  /* Better image handling in articles */
  .prose img {
    max-width: 100%;
    height: auto;
    max-height: 400px;
    width: auto;
    object-fit: contain;
    border-radius: 0.5rem;
    margin: 1rem 0;
    cursor: zoom-in;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .prose img:hover {
    transform: scale(1.02);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  /* Expanded image state (toggled via JS) */
  .prose img.expanded {
    max-height: none;
    max-width: 100%;
    cursor: zoom-out;
    transform: none;
  }

  /* Hide broken/placeholder images */
  .prose img[src=""],
  .prose img:not([src]),
  .prose img[alt^="Image"][alt$=":"] {
    display: none !important;
  }

  /* Small inline icon-like images */
  .prose img[width="16"],
  .prose img[width="20"],
  .prose img[width="24"],
  .prose img[height="16"],
  .prose img[height="20"],
  .prose img[height="24"] {
    display: inline-block;
    max-height: 1.5em;
    margin: 0 0.25em;
    vertical-align: middle;
    border-radius: 0;
  }
}

@layer utilities {
  /* Surface elevation backgrounds */
  .bg-surface-1 {
    background-color: var(--surface-1);
  }

  .bg-surface-2 {
    background-color: var(--surface-2);
  }

  .bg-surface-3 {
    background-color: var(--surface-3);
  }

  /* Glow effects */
  .ring-glow {
    --tw-ring-color: var(--glow);
    --tw-ring-opacity: 0.4;
  }

  .shadow-glow-sm {
    box-shadow: 0 0 20px -5px var(--glow);
  }

  .shadow-glow-md {
    box-shadow: 0 0 40px -10px var(--glow);
  }

  /* Hide scrollbar while maintaining scroll functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
}

/* =============================================================================
 * P3 ACCENT COLORS
 * Wide gamut colors for modern displays with fallbacks
 * Fallbacks MUST come first so @supports can override them on P3 displays
 * ============================================================================= */

/* Fallback for non-P3 displays */
:root {
  --p3-emerald: #2dd4a0;
  --p3-gold: #fbbf24;
}

.dark, .magic-blue, .classic-dark {
  --p3-emerald: #34d399;
  --p3-gold: #fcd34d;
}

@supports (color: color(display-p3 1 1 1)) {
  :root {
    --p3-emerald: color(display-p3 0.18 0.78 0.52);
    --p3-gold: color(display-p3 1 0.82 0.35);
  }

  .dark, .magic-blue, .classic-dark {
    --p3-emerald: color(display-p3 0.2 0.85 0.5);
    --p3-gold: color(display-p3 1 0.85 0.4);
  }
}

/* RTL (Right-to-Left) language support */
@layer base {
  [dir="rtl"] {
    text-align: right;
  }

  [dir="ltr"] {
    text-align: left;
  }

  [dir="rtl"].prose,
  .prose[dir="rtl"] {
    text-align: right;
  }

  [dir="rtl"] blockquote,
  [dir="rtl"].prose blockquote {
    border-left: none;
    border-right: 4px solid var(--border);
    padding-left: 0;
    padding-right: 1rem;
  }

  [dir="rtl"] ol,
  [dir="rtl"] ul {
    padding-left: 0;
    padding-right: 1.5rem;
  }

  [dir="rtl"] pre {
    direction: ltr;
    text-align: left;
  }

  [dir="rtl"] code {
    direction: ltr;
  }
}

/* Custom Clerk Checkout Button Styling */
.checkout-btn-primary button,
.checkout-btn-secondary button {
  width: 100%;
  padding: 0.625rem 1rem;
  border-radius: 0.5rem;
  font-weight: 500;
  font-size: 0.875rem;
  transition: background-color 0.15s ease, opacity 0.15s ease;
}

.checkout-btn-primary button {
  background-color: var(--foreground);
  color: var(--background);
}

.checkout-btn-primary button:hover {
  opacity: 0.9;
}

.checkout-btn-secondary button {
  background-color: var(--accent);
  color: var(--foreground);
  border: 1px solid var(--border);
}

.checkout-btn-secondary button:hover {
  opacity: 0.8;
}

/* Clerk portal/sidebar positioning */
.cl-rootBox,
.cl-card,
.cl-modalContent,
.cl-drawer,
.cl-drawerContent,
[data-clerk-portal],
[data-clerk-component] {
  z-index: 9999 !important;
}

div[style*="position: fixed"][style*="inset: 0"] > div:last-child,
.cl-subscriptionDetails,
.cl-checkout {
  z-index: 9999 !important;
}

/* Minimal Tweet Card Styling */
.tweet-card-minimal {
  --tweet-bg-color: var(--card);
  --tweet-bg-color-hover: var(--accent);
  --tweet-border: 1px solid var(--border);
  --tweet-border-radius: 1rem;
  --tweet-font-family: inherit;
  --tweet-font-color: var(--foreground);
  --tweet-font-color-secondary: var(--muted-foreground);
  --tweet-link-color: var(--foreground);
  --tweet-link-color-hover: var(--muted-foreground);
}

.tweet-card-minimal [data-theme="light"],
.tweet-card-minimal [data-theme="dark"] {
  --tweet-bg-color: var(--card) !important;
  --tweet-border: 1px solid var(--border) !important;
  --tweet-font-color: var(--foreground) !important;
  --tweet-font-color-secondary: var(--muted-foreground) !important;
}

.tweet-card-minimal .react-tweet-theme {
  margin: 0 !important;
}

.tweet-card-minimal a[href*="twitter.com"][target="_blank"]:has(span),
.tweet-card-minimal [data-testid="tweet-link"] {
  display: none !important;
}

.tweet-card-minimal [role="group"],
.tweet-card-minimal .react-tweet-actions {
  display: none !important;
}

.tweet-card-minimal a[aria-label*="Copy"],
.tweet-card-minimal a[aria-label*="copy"],
.tweet-card-minimal button[aria-label*="Copy"],
.tweet-card-minimal div:has(> a[aria-label*="Copy"]) {
  display: none !important;
}

.tweet-card-minimal img[alt=""] {
  width: 40px !important;
  height: 40px !important;
}

.tweet-card-minimal > div {
  border-radius: 1rem !important;
  padding: 1.25rem !important;
  transition: all 0.2s ease;
}

.tweet-card-minimal > div:hover {
  background-color: var(--accent) !important;
}

.tweet-card-minimal svg[viewBox="0 0 24 24"]:has(path[d*="M18.244"]) {
  opacity: 0.3;
}

.tweet-card-minimal [data-testid="User-Name"] {
  gap: 0.25rem !important;
}

.tweet-card-minimal p {
  font-size: 0.9375rem !important;
  line-height: 1.5 !important;
}

.tweet-card-minimal [data-testid="reply"] {
  display: none !important;
}

.tweet-card-minimal time {
  color: var(--muted-foreground) !important;
}

/*
 ---break---
 */

:root {
  --sidebar: hsl(0 0% 98%);
  --sidebar-foreground: hsl(240 5.3% 26.1%);
  --sidebar-primary: hsl(240 5.9% 10%);
  --sidebar-primary-foreground: hsl(0 0% 98%);
  --sidebar-accent: hsl(240 4.8% 95.9%);
  --sidebar-accent-foreground: hsl(240 5.9% 10%);
  --sidebar-border: hsl(220 13% 91%);
  --sidebar-ring: hsl(217.2 91.2% 59.8%);
}

/* =============================================================================
 * CHAT ANIMATIONS
 * Refined animations for AI chat interactions
 * ============================================================================= */

/* Message fade in animation - subtle like Perplexity */
@keyframes chat-message-in {
  from {
    opacity: 0;
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.chat-message-animate {
  animation: chat-message-in 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);
}

/* Send button pulse on first message */
@keyframes chat-send-pulse {
  0%, 100% {
    box-shadow: 0 0 0 0 var(--glow);
  }
  50% {
    box-shadow: 0 0 0 8px transparent;
  }
}

.chat-send-pulse {
  animation: chat-send-pulse 1.5s ease-in-out infinite;
}

/* Slash command menu animation */
@keyframes slash-menu-in {
  from {
    opacity: 0;
    transform: translateY(4px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.slash-menu-animate {
  animation: slash-menu-in 0.15s ease-out;
}

/* Suggestion chip hover animation */
@keyframes suggestion-shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

/* Input focus glow */
.chat-input-focus {
  transition: box-shadow 0.2s ease;
}

.chat-input-focus:focus-within {
  box-shadow: 0 0 0 2px var(--glow-muted);
}

/* Typing indicator animation */
@keyframes typing-bounce {
  0%, 60%, 100% {
    transform: translateY(0);
  }
  30% {
    transform: translateY(-4px);
  }
}

.typing-dot {
  animation: typing-bounce 1.2s ease-in-out infinite;
}

.typing-dot:nth-child(2) {
  animation-delay: 0.1s;
}

.typing-dot:nth-child(3) {
  animation-delay: 0.2s;
}

/* Get Pro button shimmer */
@keyframes shimmer {
  0% {
    background-position: 100% 50%;
  }
  50% {
    background-position: 0% 50%;
  }
  100% {
    background-position: 100% 50%;
  }
}
