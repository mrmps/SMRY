import{q as j,h as L,j as e,ag as w,ah as H,aj as h,az as k,ai as I,at as T,aA as $,r as c,B as x,s as u,ay as A,N as R,aB as _,aC as B,aD as U}from"./main-DnDeSBrj.js";import{A as Y}from"./arrow-left-BXyJhNaH.js";import{C as p}from"./crown-DivQ9sPn.js";const F=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],K=j("book-open",F);const O=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],z=j("search",O);const q=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],C=j("trash-2",q);function G(s){const i=Math.floor((new Date().getTime()-s.getTime())/1e3);if(i<60)return"just now";const t=Math.floor(i/60);if(t<60)return`${t}m ago`;const n=Math.floor(t/60);if(n<24)return`${n}h ago`;const r=Math.floor(n/24);if(r<7)return`${r}d ago`;const o=Math.floor(r/7);if(o<4)return`${o}w ago`;const f=Math.floor(r/30);return f<12?`${f}mo ago`:`${Math.floor(r/365)}y ago`}function P(s){const a=new Date,i=new Date(a.getFullYear(),a.getMonth(),a.getDate()),t=new Date(i);t.setDate(t.getDate()-1);const n=new Date(i);n.setDate(n.getDate()-7);const r=new Date(i);r.setDate(r.getDate()-30);const o=new Date(s.getFullYear(),s.getMonth(),s.getDate());return o>=i?"Today":o>=t?"Yesterday":o>=n?"This Week":o>=r?"This Month":"Earlier"}function V(s){const a=new Map,i=["Today","Yesterday","This Week","This Month","Earlier"];return i.forEach(t=>a.set(t,[])),s.forEach(t=>{const n=P(new Date(t.accessedAt)),r=a.get(n)||[];r.push(t),a.set(n,r)}),i.forEach(t=>{a.get(t)?.length===0&&a.delete(t)}),a}function W(s){return`https://icons.duckduckgo.com/ip3/${s}.ico`}function Q(s){try{const a=U(s);return`/proxy?url=${encodeURIComponent(a)}`}catch{return`/proxy?url=${encodeURIComponent(s)}`}}function X({item:s,onRemove:a,index:i}){return e.jsx("div",{className:"group animate-in fade-in slide-in-from-bottom-2 duration-200",style:{animationDelay:`${i*30}ms`,animationFillMode:"backwards"},children:e.jsxs("div",{className:u("relative flex items-start gap-3 rounded-xl p-3 transition-all duration-200","hover:bg-accent/50 dark:hover:bg-accent/30","border border-transparent hover:border-border/50"),children:[e.jsx("div",{className:"relative mt-0.5 shrink-0",children:e.jsxs("div",{className:"size-8 rounded-lg bg-muted/50 p-1.5 ring-1 ring-border/50 overflow-hidden",children:[e.jsx("img",{src:W(s.domain),alt:"",className:"size-full rounded",loading:"lazy",onError:t=>{const n=t.target;n.style.display="none";const r=n.nextElementSibling;r&&r.classList.remove("hidden")}}),e.jsx(R,{className:"hidden size-full text-muted-foreground"})]})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs(h,{to:Q(s.url),className:"block",children:[e.jsx("h3",{className:"font-medium text-[15px] text-foreground line-clamp-2 leading-snug group-hover:text-primary transition-colors",children:s.title}),e.jsxs("div",{className:"mt-1 flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx("span",{className:"truncate max-w-[180px]",children:s.domain}),e.jsx("span",{className:"text-border",children:"•"}),e.jsx(_,{className:"size-3"}),e.jsx("span",{children:G(new Date(s.accessedAt))})]})]})}),e.jsxs("div",{className:"flex items-center gap-0.5 shrink-0 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:u("h-7 w-7 flex items-center justify-center rounded-md","text-muted-foreground hover:text-foreground hover:bg-background","transition-colors"),title:"Open original",children:e.jsx(B,{className:"size-3.5"})}),e.jsx("button",{onClick:()=>a(s.id),className:u("h-7 w-7 flex items-center justify-center rounded-md","text-muted-foreground hover:text-destructive hover:bg-destructive/10","transition-colors"),title:"Remove",children:e.jsx(C,{className:"size-3.5"})})]})]})})}function J({label:s}){return e.jsx("div",{className:"sticky top-0 z-10 -mx-2 px-2 py-2 bg-background/80 backdrop-blur-sm",children:e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground/70",children:s})})}function Z(){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-in fade-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"mb-6 relative",children:[e.jsx("div",{className:"size-20 rounded-2xl bg-linear-to-br from-muted to-muted/50 flex items-center justify-center",children:e.jsx(k,{className:"size-10 text-muted-foreground/50"})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 size-6 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(K,{className:"size-3 text-primary"})})]}),e.jsx("h3",{className:"text-lg font-semibold",children:"No reading history yet"}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground max-w-[280px]",children:"Articles you read will appear here so you can easily find them again."}),e.jsx(h,{to:"/",children:e.jsx(x,{className:"mt-6",size:"sm",children:"Start reading"})})]})}function ee({query:s}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center animate-in fade-in duration-200",children:[e.jsx("div",{className:"size-14 rounded-xl bg-muted/50 flex items-center justify-center mb-4",children:e.jsx(z,{className:"size-6 text-muted-foreground/50"})}),e.jsxs("h3",{className:"text-base font-medium",children:["No results for “",s,"”"]}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Try searching with different keywords"})]})}function se({value:s,onChange:a,onClear:i}){const t=c.useRef(null);return c.useEffect(()=>{const n=r=>{(r.metaKey||r.ctrlKey)&&r.key==="k"&&(r.preventDefault(),t.current?.focus()),r.key==="Escape"&&document.activeElement===t.current&&(r.preventDefault(),t.current?.blur(),i())};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[i]),e.jsxs("div",{className:u("flex items-center gap-2 rounded-xl border bg-card px-3 py-2","transition-all duration-200","focus-within:ring-2 focus-within:ring-primary/20 focus-within:border-primary/50"),children:[e.jsx(z,{className:"size-4 text-muted-foreground shrink-0"}),e.jsx("input",{ref:t,type:"text",value:s,onChange:n=>a(n.target.value),placeholder:"Search history...",className:u("flex-1 bg-transparent text-sm outline-none","placeholder:text-muted-foreground/60")}),s&&e.jsx("button",{onClick:i,className:"shrink-0 p-0.5 rounded hover:bg-accent transition-colors",children:e.jsx(A,{className:"size-3.5 text-muted-foreground"})}),e.jsxs("kbd",{className:"hidden sm:flex items-center gap-0.5 shrink-0 px-1.5 py-0.5 rounded bg-muted text-[10px] font-medium text-muted-foreground",children:[e.jsx("span",{className:"text-xs",children:"⌘"}),"K"]})]})}function te({open:s,onClose:a,onConfirm:i}){return c.useEffect(()=>{if(!s)return;const t=n=>{n.key==="Escape"&&a()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[s,a]),s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center animate-in fade-in duration-150",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:a}),e.jsxs("div",{className:"relative bg-card border rounded-2xl p-6 shadow-xl max-w-sm mx-4 animate-in zoom-in-95 duration-200",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Clear all history?"}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"This will permanently delete your entire reading history. This action cannot be undone."}),e.jsxs("div",{className:"mt-6 flex gap-3 justify-end",children:[e.jsx(x,{variant:"outline",size:"sm",onClick:a,children:"Cancel"}),e.jsx(x,{variant:"destructive",size:"sm",onClick:()=>{i(),a()},children:"Clear all"})]})]})]}):null}function re(){const{has:s,isLoaded:a}=T(),i=a&&(s?.({plan:"premium"})??!1),{history:t,totalCount:n,hiddenCount:r,isLoaded:o,removeFromHistory:f,clearHistory:y}=$(i),[l,N]=c.useState(""),[D,v]=c.useState(!1),g=c.useMemo(()=>{if(!l.trim())return t;const m=l.toLowerCase();return t.filter(d=>d.title.toLowerCase().includes(m)||d.domain.toLowerCase().includes(m))},[t,l]),M=c.useMemo(()=>V(g),[g]),E=c.useCallback(()=>N(""),[]);return o?t.length===0?e.jsx(Z,{}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-[1fr_auto] gap-3 items-start",children:[e.jsxs("div",{className:"grid grid-rows-[auto_auto] gap-2",children:[e.jsx(se,{value:l,onChange:N,onClear:E}),e.jsx("div",{className:"h-5 flex items-center",children:l&&e.jsxs("div",{className:"text-xs text-muted-foreground animate-in fade-in slide-in-from-top-1 duration-150",children:[g.length," of ",t.length," articles"]})})]}),e.jsx("div",{className:"pt-0",children:e.jsxs(x,{variant:"ghost",size:"sm",className:"h-[38px] text-muted-foreground hover:text-destructive",onClick:()=>v(!0),children:[e.jsx(C,{className:"size-4"}),e.jsx("span",{className:"hidden sm:inline ml-1.5",children:"Clear"})]})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[n," ",n===1?"article":"articles"]}),r>0&&e.jsxs("span",{className:"text-amber-500",children:["+",r," hidden (free tier)"]})]}),g.length===0&&l?e.jsx(ee,{query:l}):e.jsx("div",{className:"space-y-1 -mx-2",children:Array.from(M.entries()).map(([m,d])=>e.jsxs("div",{children:[e.jsx(J,{label:m}),d.map((b,S)=>e.jsx(X,{item:b,onRemove:f,index:S},b.id))]},m))}),r>0&&!l&&e.jsx("div",{className:"rounded-2xl border border-amber-500/20 bg-linear-to-br from-amber-500/5 to-orange-500/5 p-5 animate-in fade-in slide-in-from-bottom-2 duration-300",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex size-11 shrink-0 items-center justify-center rounded-xl bg-linear-to-br from-amber-400 to-orange-500 shadow-lg shadow-amber-500/20",children:e.jsx(p,{className:"size-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"font-semibold text-foreground",children:[r," more ",r===1?"article":"articles"," "," ","in your history"]}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Support to unlock unlimited history & ad-free reading"}),e.jsx(h,{to:"/pricing",children:e.jsxs(x,{size:"sm",className:"mt-4",children:[e.jsx(p,{className:"mr-1.5 size-3.5"}),"Support & Unlock"]})})]})]})}),e.jsx(te,{open:D,onClose:()=>v(!1),onConfirm:y})]}):e.jsx("div",{className:"space-y-3 mt-4",children:[...Array(5)].map((m,d)=>e.jsx("div",{className:"h-16 rounded-xl bg-muted/30 animate-pulse",style:{animationDelay:`${d*100}ms`}},d))})}function ae(){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e.jsx("div",{className:"mb-6 relative",children:e.jsx("div",{className:"size-20 rounded-2xl bg-linear-to-br from-amber-400/20 to-orange-500/20 flex items-center justify-center",children:e.jsx(p,{className:"size-10 text-amber-500"})})}),e.jsx("h3",{className:"text-xl font-semibold",children:"Sign in to view history"}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground max-w-[300px]",children:"Create an account to save your reading history and access it from any device."}),e.jsx(h,{to:"/pricing",children:e.jsx(x,{className:"mt-6",children:"Get started"})})]})}function le(){const s=L();return e.jsxs("main",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx("header",{className:"sticky top-0 z-40 border-b border-border/40 bg-background/80 backdrop-blur-xl",children:e.jsxs("div",{className:"mx-auto flex max-w-2xl items-center justify-between px-4 py-3",children:[e.jsxs("button",{onClick:()=>s.history.back(),className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(Y,{className:"size-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Back"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(w,{children:e.jsx(H,{appearance:{elements:{avatarBox:"size-8"}}})}),e.jsx(h,{to:"/",className:"hover:opacity-80 transition-opacity",children:e.jsx("img",{src:"/logo.svg",alt:"smry logo",className:"dark:invert h-6"})})]})]})}),e.jsx("div",{className:"flex flex-1 flex-col px-4 py-6",children:e.jsxs("div",{className:"mx-auto w-full max-w-2xl",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"size-10 rounded-xl bg-linear-to-br from-primary/10 to-primary/5 flex items-center justify-center ring-1 ring-primary/10",children:e.jsx(k,{className:"size-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Reading History"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your recently read articles"})]})]})}),e.jsx(w,{children:e.jsx(re,{})}),e.jsx(I,{children:e.jsx(ae,{})})]})})]})}export{le as H};
